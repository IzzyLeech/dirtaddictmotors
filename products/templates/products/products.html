{% extends "base.html" %}
{% load static %}

{%  block content %}
<div class="container-fluid">

  <div>
    <label for="sort">Sort by:</label>
    <select id="sort" onchange="sortBikes(this.value)">
      <option value="" {% if default_sort == 'manufacturer' %}selected{% endif %}>Default</option>
      <option value="year" {% if default_sort == 'year' %}selected{% endif %}>Year (High to Low)</option>
      <option value="-year" {% if default_sort == '-year' %}selected{% endif %}>Year (Low to High)</option>
      <option value="price" {% if default_sort == 'price' %}selected{% endif %}>Price (High to Low)</option>
      <option value="-price" {% if default_sort == '-price' %}selected{% endif %}>Price (Low to High)</option>
      <option value="manufacturer" {% if default_sort == 'manufacturer' %}selected{% endif %}>Manufacturer (A-Z)</option>
      <option value="-manufacturer" {% if default_sort == '-manufacturer' %}selected{% endif %}>Manufacturer (Z-A)</option>
  </select>
</div>


<h1>Products</h1>
<h2>
  {% if selected_filters %}
    {% for filter_label in selected_filters %}
      {{ filter_label }}
      {% if not forloop.last %}, {% endif %}
    {% endfor %}
  {% else %}
    All Bikes
  {% endif %}

  {% if request.GET.sort == 'year' %}
  by Year
  {% elif request.GET.sort == 'price' %}
  by Price
  {% endif %}
</h2>

    <div class="row">
        {% for bike in bikes %}
        <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 ">
            <div class="product-item h-000">
            {% if bike.image %}
            <a href="{% url 'product_detail' product_id=bike.id %}">
              <img class="img-fluid" src="{{ bike.image.url }}">
            </a>
            {% else %}
            <a href="{% url 'product_detail' product_id=bike.id %}">
              <img class="img-fluid" src="{% static 'images/no_image.jpg' %}">
            </a>
            
            {% endif %}
            {{ bike.manufacturer }}
            {{ bike.model }}
            {{ bike.year }}
            {{ bike.engine_capacity|floatformat:0 }}
            {{ bike.price }}
            {{ bike.stroke }}
            </div>
            <form action="{% url 'add_to_bag' bike.id %}" method="POST">
              {% csrf_token %}
              <input type="hidden" name="quantity" value="1">
              <button type="submit" class="btn btn-primary btn-md my-0 p">
                Add to cart
                <i class="fas fa-shopping-cart ml-1"></i>
              </button>
            </form>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}